{% liquid
  if request.visual_preview_mode
    assign product = collections.all.products.first
  endif
  
  assign variant = product.selected_or_first_available_variant
  assign full_price = variant.price
  assign installment_price = full_price | divided_by: 4
%}

{% stylesheet %}
  .custom-affirm {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: -16px;
    text-align: center;
  }

  .custom-affirm__text {
    font-family: var(--font-body);
    font-weight: var(--font-weight-regular);
    line-height: 1.4;
    margin: 0;
    color: #000;
  }

  .custom-affirm__logo {
    flex-shrink: 0;
    width: 45px;
    height: 18px;
  }

  /* Mobile adjustments */
  @media screen and (max-width: 749px) {
    .custom-affirm {
      padding: 10px 12px;
      margin: 10px 0;
    }

    .custom-affirm__text {
      font-size: 15px;
    }

    .custom-affirm__logo {
      width: 40px;
      height: 16px;
    }
  }
{% endstylesheet %}

<div class="custom-affirm" {{ block.shopify_attributes }}>
  {%- if product != blank -%}
    <p class="custom-affirm__text">
      {{ full_price | money }} or 4 payments of {{ installment_price | money }}
    </p>
    <div class="custom-affirm__logo">
      <svg width="45" height="18" viewBox="0 0 45 18" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g clip-path="url(#clip0_10887_9827)">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M3.675 10.2541C2.46429 10.2541 1.06071 10.8038 0.3 11.3738L0.996429 12.7583C1.60714 12.2289 2.59286 11.781 3.48214 11.781C4.32857 11.781 4.78929 12.0457 4.78929 12.5852C4.78929 12.9517 4.47857 13.1349 3.9 13.2062C1.71429 13.4708 0 14.0409 0 15.6391C0 16.9014 0.953571 17.675 2.43214 17.675C3.49286 17.675 4.43571 17.1151 4.88571 16.3822V17.4714H6.85714V12.9008C6.85714 11.0175 5.475 10.2541 3.675 10.2541ZM2.93571 16.2091C2.37857 16.2091 2.1 15.9547 2.1 15.5271C2.1 14.7331 3.03214 14.4684 4.73571 14.2954C4.74643 15.3541 3.98571 16.2091 2.93571 16.2091ZM25.4464 11.6385V10.4577H23.475V17.4714H25.5857V14.0918C25.5857 12.4834 26.6036 12.0151 27.3214 12.0151C27.6 12.0151 27.975 12.0966 28.2214 12.2696L28.6071 10.4169C28.2857 10.2846 27.9429 10.2541 27.6643 10.2541C26.5821 10.2541 25.8964 10.7121 25.4464 11.6385ZM38.4 10.2541C37.2857 10.2541 36.45 10.8852 36.0107 11.4858C35.6036 10.702 34.7571 10.2541 33.7286 10.2541C32.6143 10.2541 31.8429 10.8445 31.4786 11.5163V10.4577H29.4429V17.4714H31.5536V13.8577C31.5536 12.5648 32.2714 11.9439 32.9357 11.9439C33.5357 11.9439 34.0929 12.3103 34.0929 13.2672V17.4714H36.2143V13.8577C36.2143 12.5445 36.9107 11.9439 37.6071 11.9439C38.1643 11.9439 38.7536 12.3307 38.7536 13.2571V17.4714H40.8643V12.6259C40.8643 11.0481 39.75 10.2541 38.4 10.2541ZM14.3143 9.93849V10.4577H11.1107V9.74508C11.1107 8.81873 11.6679 8.55406 12.15 8.55406C12.4286 8.55406 12.7929 8.61514 13.0929 8.77801L13.7464 7.36304C13.3607 7.14927 12.7286 6.95586 11.8821 6.95586C10.5321 6.95586 9 7.67861 9 9.94867V10.4678H7.77857V12.0151H9V17.4714H11.1107V12.005H14.3143V17.4714H16.425V12.005H18.3429V10.4577H16.425V9.74508C16.425 8.81873 16.9821 8.55406 17.4643 8.55406C18 8.55406 18.4071 8.77801 18.4071 8.77801L19.0607 7.36304C19.0607 7.36304 18.3964 6.95586 17.1964 6.95586C15.8571 6.94568 14.3143 7.66843 14.3143 9.93849ZM19.5964 10.4577H21.7071V17.4714H19.5964V10.4577Z" fill="black"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M31.8964 0.674988C26.1964 0.674988 21.1178 4.43128 19.6821 9.26661H21.75C22.95 5.66301 27.0321 2.50732 31.8964 2.50732C37.8107 2.50732 42.9107 6.78277 42.9107 13.4403C42.9107 14.9367 42.7071 16.2804 42.3214 17.4714H44.325L44.3464 17.4103C44.6786 16.1786 44.8393 14.845 44.8393 13.4403C44.8393 6.0193 39.15 0.674988 31.8964 0.674988Z" fill="black"/>
        </g>
        <defs>
          <clipPath id="clip0_10887_9827">
            <rect width="45" height="17" fill="white" transform="translate(0 0.674988)"/>
          </clipPath>
        </defs>
      </svg>
    </div>
  {%- else -%}
    <p class="custom-affirm__text">
      $165 or 4 payments of $41.25
    </p>
    <div class="custom-affirm__logo">
      <svg width="45" height="18" viewBox="0 0 45 18" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g clip-path="url(#clip0_10887_9827)">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M3.675 10.2541C2.46429 10.2541 1.06071 10.8038 0.3 11.3738L0.996429 12.7583C1.60714 12.2289 2.59286 11.781 3.48214 11.781C4.32857 11.781 4.78929 12.0457 4.78929 12.5852C4.78929 12.9517 4.47857 13.1349 3.9 13.2062C1.71429 13.4708 0 14.0409 0 15.6391C0 16.9014 0.953571 17.675 2.43214 17.675C3.49286 17.675 4.43571 17.1151 4.88571 16.3822V17.4714H6.85714V12.9008C6.85714 11.0175 5.475 10.2541 3.675 10.2541ZM2.93571 16.2091C2.37857 16.2091 2.1 15.9547 2.1 15.5271C2.1 14.7331 3.03214 14.4684 4.73571 14.2954C4.74643 15.3541 3.98571 16.2091 2.93571 16.2091ZM25.4464 11.6385V10.4577H23.475V17.4714H25.5857V14.0918C25.5857 12.4834 26.6036 12.0151 27.3214 12.0151C27.6 12.0151 27.975 12.0966 28.2214 12.2696L28.6071 10.4169C28.2857 10.2846 27.9429 10.2541 27.6643 10.2541C26.5821 10.2541 25.8964 10.7121 25.4464 11.6385ZM38.4 10.2541C37.2857 10.2541 36.45 10.8852 36.0107 11.4858C35.6036 10.702 34.7571 10.2541 33.7286 10.2541C32.6143 10.2541 31.8429 10.8445 31.4786 11.5163V10.4577H29.4429V17.4714H31.5536V13.8577C31.5536 12.5648 32.2714 11.9439 32.9357 11.9439C33.5357 11.9439 34.0929 12.3103 34.0929 13.2672V17.4714H36.2143V13.8577C36.2143 12.5445 36.9107 11.9439 37.6071 11.9439C38.1643 11.9439 38.7536 12.3307 38.7536 13.2571V17.4714H40.8643V12.6259C40.8643 11.0481 39.75 10.2541 38.4 10.2541ZM14.3143 9.93849V10.4577H11.1107V9.74508C11.1107 8.81873 11.6679 8.55406 12.15 8.55406C12.4286 8.55406 12.7929 8.61514 13.0929 8.77801L13.7464 7.36304C13.3607 7.14927 12.7286 6.95586 11.8821 6.95586C10.5321 6.95586 9 7.67861 9 9.94867V10.4678H7.77857V12.0151H9V17.4714H11.1107V12.005H14.3143V17.4714H16.425V12.005H18.3429V10.4577H16.425V9.74508C16.425 8.81873 16.9821 8.55406 17.4643 8.55406C18 8.55406 18.4071 8.77801 18.4071 8.77801L19.0607 7.36304C19.0607 7.36304 18.3964 6.95586 17.1964 6.95586C15.8571 6.94568 14.3143 7.66843 14.3143 9.93849ZM19.5964 10.4577H21.7071V17.4714H19.5964V10.4577Z" fill="black"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M31.8964 0.674988C26.1964 0.674988 21.1178 4.43128 19.6821 9.26661H21.75C22.95 5.66301 27.0321 2.50732 31.8964 2.50732C37.8107 2.50732 42.9107 6.78277 42.9107 13.4403C42.9107 14.9367 42.7071 16.2804 42.3214 17.4714H44.325L44.3464 17.4103C44.6786 16.1786 44.8393 14.845 44.8393 13.4403C44.8393 6.0193 39.15 0.674988 31.8964 0.674988Z" fill="black"/>
        </g>
        <defs>
          <clipPath id="clip0_10887_9827">
            <rect width="45" height="17" fill="white" transform="translate(0 0.674988)"/>
          </clipPath>
        </defs>
      </svg>
    </div>
  {%- endif -%}
</div>

{% schema %}
{
  "name": "Custom Affirm",
  "settings": [
    {
      "type": "header",
      "content": "Affirm Financing"
    },
    {
      "type": "paragraph",
      "content": "This block displays Affirm financing options with 4 equal payments. The payment amount is automatically calculated based on the selected product price."
    }
  ],
  "presets": [
    {
      "name": "Custom Affirm",
      "category": "t:categories.product",
      "settings": {}
    }
  ]
}
{% endschema %}
